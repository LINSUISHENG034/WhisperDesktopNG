# Input Assistant v2.0 - 智能窗口版

## 新功能特性

### 1. 简化的窗口选择
- **一键激活选择**: 点击"拾取窗口"按钮后，只需激活您想要输入的目标窗口即可
- **自动检测**: 程序会自动检测您激活的窗口并将其设为目标
- **取消选择**: 在等待过程中可以再次点击按钮取消选择
- **实时反馈**: 状态栏会显示当前操作状态和选择结果

### 2. 可折叠调试控制台
- **默认隐藏**: 程序启动时调试信息默认隐藏，界面更简洁
- **一键切换**: 点击"显示调试信息"按钮可展开/收起调试控制台
- **动态窗口**: 显示调试信息时窗口自动扩大，隐藏时自动缩小
- **完整日志**: 调试模式下可查看详细的操作日志和错误信息

### 3. 用户体验改进
- **直观操作**: 无需复杂的鼠标点击选择，直接激活目标窗口即可
- **清晰状态**: 界面清楚显示当前选择的窗口和操作状态
- **美观界面**: 默认隐藏调试信息，保持界面简洁美观
- **灵活调试**: 需要时可随时查看调试信息进行问题排查

## 使用方法

### 基本操作流程
1. **启动程序**: 运行 InputAssistant.exe
2. **输入文本**: 在文本框中输入要自动输入的内容
3. **选择窗口**: 
   - 点击"拾取窗口"按钮
   - 激活您想要输入文本的目标窗口（如记事本、浏览器等）
   - 程序会自动检测并选择该窗口
4. **设置延迟**: 调整字符间延迟时间（默认50毫秒）
5. **开始输入**: 点击"开始输入"按钮开始自动输入

### 调试功能
- **显示调试信息**: 点击此按钮可展开调试控制台
- **查看日志**: 在调试控制台中查看详细的操作日志
- **清空日志**: 点击"清空"按钮清除调试信息
- **隐藏调试信息**: 再次点击切换按钮可收起调试控制台

### 窗口选择说明
- **等待状态**: 点击"拾取窗口"后，按钮文字变为"取消选择"
- **激活目标**: 直接点击或切换到您想要输入的窗口
- **自动选择**: 程序检测到窗口激活后自动完成选择
- **取消操作**: 在等待过程中可点击"取消选择"按钮取消

## 技术改进

### 窗口选择机制
- 移除了复杂的鼠标钩子和消息过滤器
- 使用简单的定时器检测前台窗口变化
- 避免了窗口最小化和光标变化等干扰操作
- 提供更稳定可靠的窗口选择体验

### 界面优化
- 默认窗口大小: 520x450 (隐藏调试信息时)
- 调试模式大小: 520x600 (显示调试信息时)
- 动态调整窗口大小以适应不同使用场景
- 保持窗口置顶以便随时操作

### 资源管理
- 正确释放定时器资源
- 优化内存使用
- 改进异常处理机制

## 版本历史

### v2.0.1 (当前版本) - 修复停止和暂停功能
- **修复停止按钮**: 改进取消逻辑，提供更好的用户反馈
- **修复暂停按钮**: 完善暂停/恢复状态切换，正确更新界面状态
- **增强调试功能**: 添加详细的按钮状态和操作过程日志
- **改进异常处理**: 在暂停和延迟期间正确处理取消操作
- **优化用户体验**: 实时状态反馈，清晰的操作提示

### v2.0 (2025-06-29)
- 简化窗口选择机制
- 添加可折叠调试控制台
- 改进用户界面和体验
- 优化资源管理

### v1.0
- 基础自动输入功能
- 复杂的窗口选择器
- 固定显示调试信息

## 注意事项

1. **管理员权限**: 某些应用程序可能需要管理员权限才能接收输入
2. **窗口焦点**: 确保目标窗口能够接收键盘输入
3. **输入法状态**: 建议在英文输入状态下使用以获得最佳效果
4. **特殊字符**: 程序支持Unicode字符，包括中文等多语言文本
5. **延迟设置**: 根据目标应用程序的响应速度调整字符间延迟

## 功能测试

### 停止和暂停功能测试
1. **停止功能测试**:
   - 输入较长的文本（如100个字符以上）
   - 点击"开始输入"开始自动输入
   - 在输入过程中点击"停止"按钮
   - 验证输入立即停止，状态显示"输入已被用户取消"

2. **暂停功能测试**:
   - 开始自动输入过程
   - 在输入过程中点击"暂停"按钮
   - 验证输入暂停，按钮文字变为"恢复"，状态显示"输入已暂停"
   - 点击"恢复"按钮继续输入
   - 验证输入恢复，按钮文字变为"暂停"，状态显示"输入已恢复"

3. **调试日志验证**:
   - 启用调试模式查看详细操作日志
   - 验证按钮状态变化和操作过程都有相应日志记录

## 故障排除

### 窗口选择问题
- 确保目标窗口是可见且可激活的
- 避免选择系统窗口或受保护的应用程序
- 如果选择失败，可查看调试信息了解详细原因

### 输入问题
- 检查目标窗口是否具有输入焦点
- 确认目标应用程序支持程序化输入
- 尝试调整字符间延迟时间

### 停止/暂停问题
- 如果停止按钮无响应，检查调试日志中的错误信息
- 暂停功能在字符间延迟期间最为有效
- 确保在输入过程中（isRunning=true）时按钮才会启用

### 调试信息
- 启用调试模式查看详细的操作日志
- 检查错误消息和警告信息
- 根据日志信息进行问题诊断
